<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stock Performance Benchmarker</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Stock Performance Benchmarker</h1>
            <p class="subtitle">Compare any stock against major market benchmarks</p>
        </header>

        <main>
            <!-- Ticker Input Section -->
            <section class="input-section">
                <h2>Enter Stock Tickers</h2>
                <p class="section-hint">Enter up to 3 tickers, select which benchmarks to include, then hit Compare</p>

                <div class="ticker-input-row">
                    <div class="ticker-group">
                        <label for="ticker-input-1">Ticker 1</label>
                        <input type="text" id="ticker-input-1" placeholder="e.g. AAPL" maxlength="10" autocomplete="off" spellcheck="false">
                    </div>
                    <div class="ticker-group">
                        <label for="ticker-input-2">Ticker 2</label>
                        <input type="text" id="ticker-input-2" placeholder="e.g. MSFT" maxlength="10" autocomplete="off" spellcheck="false">
                    </div>
                    <div class="ticker-group">
                        <label for="ticker-input-3">Ticker 3</label>
                        <input type="text" id="ticker-input-3" placeholder="e.g. GOOGL" maxlength="10" autocomplete="off" spellcheck="false">
                    </div>
                    <button class="action-btn compare-btn" id="compare-btn" onclick="handleCompare()">Compare</button>
                    <button class="action-btn export-btn" id="export-btn" onclick="exportToSheets()" disabled>Export to Google Sheets</button>
                </div>
                <span id="input-status" class="save-status"></span>
            </section>

            <!-- Benchmark Selection Section -->
            <section class="benchmark-section">
                <h2>Select Benchmarks</h2>
                <p class="section-hint">Check the benchmarks you want to compare against</p>

                <div class="benchmark-grid" id="benchmark-grid">
                    <!-- Populated by JavaScript -->
                </div>

                <div class="benchmark-actions">
                    <button class="action-btn select-all-btn" onclick="toggleAllBenchmarks(true)">Select All</button>
                    <button class="action-btn deselect-all-btn" onclick="toggleAllBenchmarks(false)">Deselect All</button>
                </div>
            </section>

            <!-- Results Section -->
            <section class="performance-section" id="results-section" style="display:none;">
                <h2>Performance Comparison — <span id="results-ticker"></span></h2>
                <p class="section-hint">All values are percentage returns for the given period</p>

                <div class="table-container">
                    <table class="performance-table" id="performance-table">
                        <thead>
                            <tr>
                                <th>Ticker</th>
                                <th>Name</th>
                                <th>1 Day</th>
                                <th>1 Week</th>
                                <th>1 Month</th>
                                <th>3 Month</th>
                                <th>6 Month</th>
                                <th>1 Year</th>
                                <th>YTD</th>
                            </tr>
                        </thead>
                        <tbody id="stocks-body">
                            <!-- Populated by JavaScript -->
                        </tbody>
                    </table>
                </div>

                <div class="table-actions">
                    <button class="action-btn refresh-btn" onclick="handleCompare()">Refresh Data</button>
                    <span id="save-status" class="save-status"></span>
                </div>
            </section>

            <!-- Legend -->
            <section class="legend-section" id="legend-section" style="display:none;">
                <h2>Benchmark Legend</h2>
                <div class="legend-grid">
                    <div class="legend-item"><span class="legend-ticker">VOO</span> Vanguard S&amp;P 500 ETF — Large-cap US equities</div>
                    <div class="legend-item"><span class="legend-ticker">QQQ</span> Nasdaq-100 ETF — US tech &amp; growth</div>
                    <div class="legend-item"><span class="legend-ticker">IWM</span> Russell 2000 ETF — US small-cap equities</div>
                    <div class="legend-item"><span class="legend-ticker">EFA</span> iShares MSCI EAFE — International developed markets</div>
                    <div class="legend-item"><span class="legend-ticker">IBIT</span> iShares Bitcoin Trust — Bitcoin exposure</div>
                    <div class="legend-item"><span class="legend-ticker">^GSPC</span> S&amp;P 500 Index — Direct index value</div>
                    <div class="legend-item"><span class="legend-ticker">^SP500TR</span> S&amp;P 500 Total Return — With dividends reinvested</div>
                    <div class="legend-item"><span class="legend-ticker">^NDXT</span> Nasdaq-100 Tech Index — Tech sector of Nasdaq-100</div>
                    <div class="legend-item"><span class="legend-ticker">^XCMP</span> Nasdaq Composite Total Return — All Nasdaq with dividends</div>
                    <div class="legend-item"><span class="legend-ticker">^RUTTR</span> Russell 2000 Total Return — Small-cap with dividends</div>
                </div>
            </section>
        </main>

        <footer>
            <p>Stock Performance Benchmarker &mdash; Data via Yahoo Finance</p>
        </footer>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/exceljs@4.4.0/dist/exceljs.min.js"></script>
    <script src="app.js"></script>
</body>
</html>
